import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Scanner;

/**
 * 출력 -> System.out.print
 * 입력 -> Scanner(System.in)
 * 
 * @author super
 *
 */

public class MainTest {
	
	Model model = new Model();
	View view = new View();
	
	public static void main(String[] args) {
		// 입력을 받아서 처리하는 도구
		Scanner scanner = new Scanner(System.in);
		MemoMain main = new MemoMain();
	
		// 명령어를 입력받아서 후속 처리
		// c -create : 데이터 입력모드로 전환
		// r -read : 데이터 읽기모드로 전환
		// u -update : 데이터  수정모드로 전환
		// d =delete : 데이터 삭제모드로 전환
		
		String command = "";
		
		
		while(!command.equals("exit")) {
			main.println("------- 명령어를 입력하세요 --------");
			main.println("c : 쓰기, r : 읽기, u : 수정, d : 삭제, l : 목록");
			main.println("-----------------------------");
			main.println("exit : 종료");
			main.println("-----------------------------");
			command = scanner.nextLine();
			// 명령어를 분기처리
			switch(command) {
			case "c":
				Memo memo = main.view.create(scanner);
				//메모 데이터에 대한 조작이 필요할 경우 모두 컨트롤러에서 작업한다.
				main.model.create(memo);
				break;
			case "r":
				main.read(scanner);
				break;
			case "u":
				main.update(scanner);
				break;
			case "d":
				main.delete(scanner);
				break;
			case "l":
				main.showList();
				break;
			}
		}
		
		System.out.println("시스템이 종료되었습니다!");
		
		// 키보드 입력중에 Enter키가 입력될때까지 대기
		/*String test = scanner.nextLine(); 
		System.out.println(test);*/
		
		// 키보드 입력을 받는 함수
		
		
	}
	
	public Memo create(Scanner scanner) {
		
		public Memo create() {
			Memo memo = new Memo();
			
			System.out.println("이름을 입력하세요 : ");
			memo.name = scanner.nextLine();	
			System.out.println("내용을 입력하세요 :");
			memo.content = scanner.nextLine();
			// 날짜
			memo.datetime = System.currentTimeMillis();
			
			return memo;
			//model.create(memo);
		// 글 하나를 저장하기 위한 메모리 공간 확보
		
		
	}
	
	public void read(Scanner scanner) {
		System.out.println("글 번호를 입력하세요");
		
		//--------숫자가 입력되지 않았을 때의 예외 처리------//
		String tempNo = scanner.nextLine();
		int no = Integer.parseInt(tempNo);
		
		for (Memo memo : list) {
			if (memo.no == no) {
				print("No : " + memo.no);
				print(" | Auther : " + memo.name);
				println(" | Content : " + memo.content);
				
				// 숫자로 입력받은 날짜값을 실제 날짜로 변경
				SimpleDateFormat sdf = new SimpleDateFormat ("yyyy-MM-dd hh:mm:ss");
				String formattedDate = sdf.format(memo.datetime);
				println("Date : " + formattedDate);
				
				break;
			}
		}
	}
	
	public void update(Scanner scanner) {
		System.out.println("글 번호를 입력하세요");
		//--------숫자가 입력되지 않았을 때의 예외 처리------//
		String tempNo = scanner.nextLine();
		int no = Integer.parseInt(tempNo);
		
		for (Memo memo : list) {
			if (memo.no == no) {
				System.out.println("이름을 입력하세요 : ");
				memo.name = scanner.nextLine();	
				System.out.println("내용을 입력하세요 :");
				memo.content = scanner.nextLine();
				// 날짜
				memo.datetime = System.currentTimeMillis();
				break;
			}
		}
	}
	
	public void delete(Scanner scanner) {
		System.out.println("글 번호를 입력하세요");
		//--------숫자가 입력되지 않았을 때의 예외 처리------//
		String tempNo = scanner.nextLine();
		int no = Integer.parseInt(tempNo);
		
		for (Memo memo : list) {
			if (memo.no == no) {
				list.remove(memo); // ArrayList의 아이템을 삭제하기 위해서 객체를 직접 전달
				break;
			}
		}
	}
	
	public void showList() {
		// ArrayList 저장소를 반복문을 돌면서 한줄씩 출력
		for(Memo memo : list) {
			System.out.print("No : " + memo.no);
			System.out.print(" | Auther : " + memo.name);
			System.out.println(" | Content : " + memo.content);
			//index++;
		}
	}
	
	public void print(String string) {
		System.out.println(string);
	}
	
	public void println(String string) {
		System.out.println(string);
	}
}

// 데이터를 저장하는 저장소를 관리하는 객체
class Model {
	// 전체 메모를 저장하는 저장소
	ArrayList<Memo> list = new ArrayList<>();
	// 마지막 글번호
	int lastIndex = 0;
	
	public void create(Memo memo) {
		// 글번호
		memo.no = list.Index++;
		// 글 하나를 저장한 메모리를 저장소로 이동
		list.add(memo);
	}
}


// 개별 글 한개 한개를 저장하는 클래스
class Memo {
	int no;
	String name;
	String content;
	long datetime;
}